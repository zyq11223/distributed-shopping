本系统的接口秒杀优化的基本思路是减少对于数据库的访问，总体来说分为如下几步：
![输入图片说明](https://images.gitee.com/uploads/images/2018/1013/232932_6bf7f39a_1648495.png "1.png")<br>

### 系统初始化
商品库存数量预先加载到Redis缓存中，如此一来可减少对于数据库的访问，提升性能。由于，我们访问Redis时亦会产生一定的网络开销，故如若库存数量stockcount小于等于0，我们将参与被秒杀的商品标记为"秒杀完毕"，下次，当用户准备秒杀商品时，无需访问Redis缓存即可知晓是否可以去秒杀该商品。如此一来，进一步提升了网络性能。

### 预减库存

  Redis在收到请求后，预先将商品库存数量stockcount减1，到stockcount值小于等于0时，直接返回库存不足错误，同时将该商品标记为"秒杀完毕"，免去在这之后的一切判断或操作。

### 异步下单
   服务器收到秒杀请求之后，不去访问数据库，而是将商品id与用户信息作为一个消息实体<user,goodsId>，放入一个消息队列中（本系统使用rabbitMQ消息队列中间件),增强了用户体验。<br>
![输入图片说明](https://images.gitee.com/uploads/images/2018/1014/233254_e18c5f45_1648495.png "4.png")<br>
客户端将消息实体放入消息队列中后将会轮询是否秒杀成功。另一方面，服务端在收到消息实体后，做出队操作，在数据库中做减库存操作，成功后创建订单，同时将订单写入到Redis缓存中。
 

